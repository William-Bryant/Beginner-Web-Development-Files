<!-- This is a personal remake of the popular web/mobile game Wordle -->
<!DOCTYPE html>
<html>
    <head>
        <link href="https://fonts.googleapis.com/css2?family=Fuzzy+Bubbles:wght@700&display=swap" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdn.anychart.com/releases/8.0.0/js/anychart-base.min.js"></script>
        <script src="https://cdn.anychart.com/releases/8.11.0/themes/dark_turquoise.js" type="text/javascript">   </script>
         <script type="text/javascript" src="wordBank.js"></script>
        <link rel="stylesheet" href="wordle.css">
    </head>
    <body>

    <table class = "title"> <!-- Title -->
        <tr>
            <td class = "title">
                <h1> Welcome to Bry's Wordle</h1>
            </td>
        </tr>
    </table>
    <table>  <!-- Main Grid -->
        <tr> <!-- Row 1 -->
            <td id = "0"></td>
            <td id = "1"></td>
            <td id = "2"></td>
            <td id = "3"></td>
            <td id = "4"></td>
        </tr>
        <tr> <!-- Row 2 -->
            <td id = "5"></td>
            <td id = "6"></td>
            <td id = "7"></td>
            <td id = "8"></td>
            <td id = "9"></td>
        </tr>
        <tr> <!-- Row 3 -->
            <td id = "10"></td>
            <td id = "11"></td>
            <td id = "12"></td>
            <td id = "13"></td>
            <td id = "14"></td>
        </tr>
        <tr> <!-- Row 4 -->
            <td id = "15"></td>
            <td id = "16"></td>
            <td id = "17"></td>
            <td id = "18"></td>
            <td id = "19"></td>
        </tr>
        <tr> <!-- Row 5 -->
            <td id = "20"></td>
            <td id = "21"></td>
            <td id = "22"></td>
            <td id = "23"></td>
            <td id = "24"></td>
        </tr>
        <tr> <!-- Row 6 -->
            <td id = "25"></td>
            <td id = "26"></td>
            <td id = "27"></td>
            <td id = "28"></td>
            <td id = "29"></td>
        </tr>
    </table> 
    <table class = "keyboard1"> <!-- Keyboard 1 -->
        <td class = keyboard1 id = "Q">Q</td>
        <td class = keyboard1 id = "W">W</td>
        <td class = keyboard1 id = "E">E</td>
        <td class = keyboard1 id = "R">R</td>
        <td class = keyboard1 id = "T">T</td>
        <td class = keyboard1 id = "Y">Y</td>
        <td class = keyboard1 id = "U">U</td>
        <td class = keyboard1 id = "I">I</td>
        <td class = keyboard1 id = "O">O</td>
        <td class = keyboard1 id = "P">P</td>
    </table>
    <table class = "keyboard2"> <!-- Keyboard 2 -->
        <td class = keyboard2 id = "A">A</td>
        <td class = keyboard2 id = "S">S</td>
        <td class = keyboard2 id = "D">D</td>
        <td class = keyboard2 id = "F">F</td>
        <td class = keyboard2 id = "G">G</td>
        <td class = keyboard2 id = "H">H</td>
        <td class = keyboard2 id = "J">J</td>
        <td class = keyboard2 id = "K">K</td>
        <td class = keyboard2 id = "L">L</td>
    </table>
    <table class = "keyboard3"> <!-- Keyboard 3 -->
        <td class = keyboard3 id = "Z">Z</td>
        <td class = keyboard3 id = "X">X</td>
        <td class = keyboard3 id = "C">C</td>
        <td class = keyboard3 id = "V">V</td>
        <td class = keyboard3 id = "B">B</td>
        <td class = keyboard3 id = "N">N</td>
        <td class = keyboard3 id = "M">M</td>
    </table>

    <table class = "entry"> <!-- Text Entry -->
    <td class = "entry"><input class = "entry" type = "text" autofocus id = "entry"> </td>
    </table>
    <table class = "btn"> <!-- Button -->
        <td class = "btn"><input class = "btn" type = "button" id = "btn_1" value = "Try it"></td>
    </table>
        
    <div id = "endScreen">
        <table class = "endScreen">
            <tr><td class = "spacer"> &nbsp&nbsp </td><td class = "endScreen1" id = "gamesPlayed"></td><td class = "endScreen1" id = "winPercentage"></td><td class = "endScreen1" id = "currentStreak"></td><td class = "endScreen1" id = "highestStreak"></td><td class = "spacer"><input  type = "button" class = "end" id = "btn_end" value = "X"></td></tr>
            <tr><td class = "spacer"></td><td class = "endScreen2">Games<br>played</td><td class = "endScreen2">win %</td><td class = "endScreen2">Current Streak</td><td class = "endScreen2">Highest Streak</td><td class = "spacer"></td></tr>
            <tr><td class = "spacer"></td><td class = "endScreen3" id = "chart" colspan = "4"></td></tr>
        
        </table>
    </div>
    <div id = "win">
        <table class = "win">
            <tr><td class = "win">well done!</td></tr>
        </table>
    </div>
    <div id = "lose">
        <table class = "lose">
            <tr><td class = "lose">tough one!</td></tr>
        </table>
    </div>
    <div id = "lengthError">
        <table class = "Error">
            <tr><td class = "Error">Words must be 5 letters long!</td></tr>
        </table>
    </div>
    <div id = "numberError">
        <table class = "Error">
            <tr><td class = "Error">Words cannot contain numbers!</td></tr>
        </table>
    </div>
    <div id = "wordError">
        <table class = "Error">
            <tr><td class = "Error">Not a real word!</td></tr>
        </table>
    </div>

    </body>
    <script type="text/javascript">        
            var number = Math.floor(Math.random() * 101)
            
            let nameVariable = names[number]
    </script>

    <script>
        $("#wordError").hide()
        $("#lengthError").hide()
        $("#numberError").hide()
        $("#win").hide()
        $("#lose").hide()
        $("#endScreen").hide()
        //Initiate score counters
        let gamesPlayed = 0
        let gamesWon = 0
        let winPercentage = (gamesWon / gamesPlayed) * 100
        let currentStreak = 0
        let highestStreak = 0 
        let oneGuess = 0
        let twoGuess = 0
        let threeGuess = 0
        let fourGuess = 0
        let fiveGuess = 0
        let sixGuess = 0
        //Generate Answer
        let answer = nameVariable.toUpperCase()
        console.log("word: ", answer)
        //turn the answer into a list
        let answerList = [] 
        for (let i = 0; i < answer.length; i++){
                answerList.push(answer[i])
        }
       //Initiate game counters
        let counter = 0
        let guessCounter = 0
        let guess = ""

        //Main game loop
        $("#btn_1").click(function(){
        //Error Trap Checks
        
            let guess = $("#entry").val().toUpperCase();
            
            if (guess.length != 5){
                $("#lengthError").fadeIn(400).delay(1000).fadeOut(400)  
            }
            else if (strCheck(guess) == false){
                $("#numberError").fadeIn(400).delay(1000).fadeOut(400)  
            }
            else if (!(names.includes(guess.toLowerCase()))){
                $("#wordError").fadeIn(400).delay(1000).fadeOut(400)  
            }
            else{
                document.getElementById("entry").value = ""
                game(guess)
            }
        });
        $("#btn_end").click(function(){
          clear()
          $("#endScreen").hide()
        })
    // Game Functions Below    
    function game(guess){
        
        let guessList = []
        let reset = true
            for (let i = 0; i < guess.length; i++){
                
                setTimeout(() => {
                guessList.push(guess[i])
                $("#"+counter).html(guessList[i])
                document.getElementById(guess[i]).style.backgroundColor='#808080'
                if (answerList.includes(guessList[i])){
                    if (guessList[i] == answerList[i]){ //checks for exact match
                    document.getElementById(counter).style.backgroundColor='#00FF00'  
                }   if (guessList[i] != answerList[i]){
                    
                    document.getElementById(counter).style.backgroundColor='#FFFF00'
                }
                }
                else{
                    document.getElementById(counter).style.backgroundColor='#808080'
                }
                if (guess == answer && reset == true){
                   
                    reset = false
                    setTimeout(() =>{
                    showWin()
                    },1000)
                    setTimeout(() =>{
                    gameWon(i)
                    scoreUpdate(counter)
                    stats()
                    $("#endScreen").show()  
                },1600)
                }
                counter += 1
            },200 * (i+1))

        }
        guessCounter +=1 
        if (guessCounter == 6 && guess != answer){
            setTimeout(() =>{showLoss()},1000)
            setTimeout(() =>{
            gameLoss()
            scoreUpdate()
            stats()
            $("#endScreen").show()
            },1600)
            }}
    function stats(){
    document.getElementById("chart").innerHTML = ""
    anychart.theme(anychart.themes.darkTurquoise)
        var data = {
    header: ["Guess Count", "Frequence"],
      rows: [
        ["1", oneGuess],
        ["2", twoGuess],
        ["3", threeGuess],
        ["4", fourGuess],
        ["5", fiveGuess],
        ["6", sixGuess]
    ]};
    var chart = anychart.bar();
    chart.padding([0, 40, 10, 30]);
    chart.data(data);
    chart.title("Guess Distribution");
    chart.container("chart");
    chart.yScale().maximum(4)
    chart.draw();

        }

    function strCheck(str){
        
        let punct = ['[','!','#','$','%','&',"'",'(', ')','*','+',',','-','.','/',':',';','<','=','>','?','@','[','\\',']','^','_','`','{','|','}','~',']']
        let punctCounter = 0
        for (let i = 0;i < str.length;i++){
            if (punct.includes(str[i])) {
                punctCounter += 1
            }}
        if (punctCounter > 0){
            return false
        }
        else{
            if (/\d/.test(str) == false){
                return true
            }
            else{
                return false
            }}}
        var input = document.getElementById("entry");
    input.addEventListener("keyup", function(event) { 
    if (event.keyCode === 13) {
    event.preventDefault();
    document.getElementById("btn_1").click();
  }
});

function clear(){
    let alphabet = ["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","Z","Z","Z","Z"]
    for (let x = 0; x < 1; x++){
                for (let i = 0; i < 30; i++){
        
        $("#"+i).html("")
        document.getElementById(i).style.backgroundColor= 'revert'
        document.getElementById(alphabet[i]).style.backgroundColor='revert'
    }
     number = Math.floor(Math.random() * 101)
     answer = names[number].toUpperCase()
        console.log(answer)
        
        answerList = []
        //turn new answer into a list
        for (let i = 0; i < answer.length; i++){
                answerList.push(answer[i])
        }
        counter = 0
        guessCounter = 0
        guess = ""    
    }
    $("#win").hide()
    $("#lose").hide()    
}
function scoreUpdate(){
    document.getElementById('gamesPlayed').innerHTML = gamesPlayed
    document.getElementById('winPercentage').innerHTML = winPercentage
    document.getElementById('currentStreak').innerHTML = currentStreak
    document.getElementById('highestStreak').innerHTML = highestStreak
}
function gameWon(i){
    gamesPlayed += 1
    gamesWon += 1
    currentStreak += 1
    if (currentStreak > highestStreak){
        highestStreak = currentStreak
    }
    winPercentage = Math.round(((gamesWon / gamesPlayed) *100), 2)
    let roundWon = 0 
        roundWon = counter / 5    
    if (roundWon == 1){
        oneGuess += 1
    }
    else if (roundWon == 2){
        twoGuess += 1  
    }
    else if (roundWon == 3){
        threeGuess += 1
    }
    else if (roundWon == 4){
        fourGuess += 1
    }
    else if (roundWon == 5){
        fiveGuess += 1
    }
    else if (roundWon == 6){
        sixGuess += 1
    }}
function gameLoss(){
    gamesPlayed += 1
    currentStreak = 0
    winPercentage = Math.round(((gamesWon / gamesPlayed) *100), 2)
}
function showWin(){
    $("#win").show()
}
function showLoss(){
    $("#lose").show()
}
    </script>
</html>
